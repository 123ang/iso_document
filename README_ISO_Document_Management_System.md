# ISO Document Management System

A **role-based ISO document management system** designed for organizations that prefer **form-based administration**, simple access control, and **clear version management** without unnecessary workflow complexity.

This system is optimized for ISO-style documentation repositories (e.g. ISO 9001, internal audits, meeting minutes).

---

## ğŸš€ Key Features

- Two roles only: **Admin** and **User**
- Form-based admin workflow (no Google Driveâ€“style folder UI)
- Shortcut-based left panel auto-generated by access rights
- Group-based access control
- Document versioning (**Policy A**)
- Admin controls which version users see
- Users see only the current version
- Rollback to previous versions supported
- Secure file streaming (no public links)

---

## ğŸ§‘â€ğŸ’¼ Roles & Permissions

### Roles
| Role  | Description |
|------|------------|
| Admin | Full control over document sets, documents, versions, groups, and users |
| User  | View and download current document versions only |

### Permission Matrix

| Action | Admin | User |
|------|------|------|
| Create document set | âœ… | âŒ |
| Upload document | âœ… | âŒ |
| Upload new version | âœ… | âŒ |
| Set current version | âœ… | âŒ |
| Create / manage groups | âœ… | âŒ |
| Assign user to group | âœ… | âŒ |
| View documents | âœ… | âœ… |
| Download documents | âœ… | âœ… |
| View version history | âœ… | âŒ |

---

## ğŸ§  Core Concepts

### Document Set
A **Document Set** represents a logical container and appears as a **shortcut in the left panel** for users who have access.

Examples:
- Online Documents
- Internal Audit
- ISO 9001:2015
- Meeting Minutes

Document Sets are created via **admin forms**, not via folder browsing.

---

### Group-Based Access Control

```
User â†’ Group â†’ Document Set â†’ Documents â†’ Versions
```

- Users only see document sets assigned to their groups
- Left panel is auto-generated per user
- No access = completely hidden

---

## ğŸ–¥ï¸ User Interface Overview

### Left Panel
- Displays accessible **Document Sets**
- Acts as shortcut links (not folder trees)

### Right Panel
- Lists documents inside selected document set
- Columns:
  - Document Name
  - Modified Date
  - Modified By
  - Actions: View / Download

> Users never see version history.

---

## ğŸ› ï¸ Admin Workflows

### 1. Create Document Set (Form-Based)

**Fields**
- Title (required)
- Category (optional)
- Description (optional)
- Access Groups (multi-select)
- Sort Order

Result:
- Document Set appears automatically for permitted users

---

### 2. Upload New Document

**Fields**
- Document Set
- Document Title
- Document Code (optional)
- File Upload
- Version Type (Major / Minor)
- Change Notes

Result:
- Version created (e.g. `v1.0`)
- Not visible to users until set as current

---

### 3. Upload New Version

- Creates a new version record
- Does not overwrite previous files
- Admin manually selects which version is current

---

### 4. Set Current Version (Publish / Rollback)

- Admin selects any version
- Clicks **Set as Current**
- Users instantly see the selected version
- Enables rollback to older versions

---

## ğŸ”„ Versioning Policy (Policy A)

- Only **one version** is marked as current
- Users see **only the current version**
- Version history is **admin-only**
- Rollback supported at any time

---

## ğŸ—ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Web Client      â”‚
â”‚   (React Frontend) â”‚
â”‚                    â”‚
â”‚ - Login            â”‚
â”‚ - Left Shortcuts   â”‚
â”‚ - Document List    â”‚
â”‚ - Admin Forms      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ HTTPS (JWT)
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        API Server           â”‚
â”‚   (Node.js / Express)       â”‚
â”‚                             â”‚
â”‚ - Auth & Role Middleware    â”‚
â”‚ - Group Access Control      â”‚
â”‚ - Version Management        â”‚
â”‚ - File Streaming            â”‚
â”‚ - Audit Logging (optional)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚           â”‚
          â–¼           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MySQL DB     â”‚  â”‚     File Storage        â”‚
â”‚                â”‚  â”‚ (Local / S3-compatible) â”‚
â”‚ - Users        â”‚  â”‚ /document_sets/          â”‚
â”‚ - Groups       â”‚  â”‚   /documents/            â”‚
â”‚ - DocumentSets â”‚  â”‚     /versions/           â”‚
â”‚ - Documents    â”‚  â”‚                          â”‚
â”‚ - Versions     â”‚  â”‚                          â”‚
â”‚ - Access Maps  â”‚  â”‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—„ï¸ Database Schema (MySQL)

### Users

```sql
users (
  id BIGINT PRIMARY KEY,
  name VARCHAR(100),
  email VARCHAR(150),
  password_hash VARCHAR(255),
  role ENUM('admin','user'),
  created_at DATETIME
);
```

### Groups

```sql
groups (
  id BIGINT PRIMARY KEY,
  name VARCHAR(100),
  description TEXT
);

user_groups (
  user_id BIGINT,
  group_id BIGINT,
  PRIMARY KEY (user_id, group_id)
);
```

### Document Sets

```sql
document_sets (
  id BIGINT PRIMARY KEY,
  title VARCHAR(200),
  category VARCHAR(100),
  description TEXT,
  sort_order INT,
  created_by BIGINT,
  created_at DATETIME,
  updated_by BIGINT,
  updated_at DATETIME
);

document_set_groups (
  document_set_id BIGINT,
  group_id BIGINT,
  PRIMARY KEY (document_set_id, group_id)
);
```

### Documents

```sql
documents (
  id BIGINT PRIMARY KEY,
  document_set_id BIGINT,
  title VARCHAR(200),
  doc_code VARCHAR(50),
  current_version_id BIGINT,
  created_by BIGINT,
  created_at DATETIME,
  updated_by BIGINT,
  updated_at DATETIME
);
```

### Document Versions

```sql
document_versions (
  id BIGINT PRIMARY KEY,
  document_id BIGINT,
  version_major INT,
  version_minor INT,
  version_label VARCHAR(10),
  change_notes TEXT,
  file_path VARCHAR(255),
  original_filename VARCHAR(255),
  mime_type VARCHAR(100),
  size_bytes BIGINT,
  checksum_sha256 CHAR(64),
  is_current BOOLEAN DEFAULT FALSE,
  created_by BIGINT,
  created_at DATETIME
);
```

---

## ğŸ“ File Storage Structure

```
/storage/
  /document_sets/{set_id}/
    /documents/{document_id}/
      /versions/{version_label}/file.ext
```

---

## ğŸ”Œ API Endpoints

### User APIs
```
GET /api/me/document-sets
GET /api/document-sets/:id/documents
GET /api/versions/:id/view
GET /api/versions/:id/download
```

### Admin APIs
```
POST /api/document-sets
PUT /api/document-sets/:id
POST /api/documents
POST /api/documents/:id/versions
POST /api/documents/:id/set-current-version
POST /api/groups
POST /api/users
```

---

## ğŸ” Security Notes

- JWT authentication
- Role-based middleware
- File access via API only
- Optional audit logs for ISO traceability

---

## ğŸ§° Suggested Tech Stack

- Frontend: React + MUI / Ant Design
- Backend: Node.js (Express or NestJS)
- Database: MySQL
- Storage: Local FS (S3-ready)

---

## âœ… Summary

This system:
- Matches ISO document repository patterns
- Is easy for admin users
- Avoids unnecessary complexity
- Supports controlled versioning
- Is production-ready and extensible
